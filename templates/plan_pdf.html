<!DOCTYPE html>
<html>
<head>
    <title>Your Diet Plan</title>
    <style>
        body { font-family: sans-serif; color: #333; }
        h1 { color: #27AE60; }
        h2 { border-bottom: 2px solid #27AE60; padding-bottom: 5px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; vertical-align: top; }
        th { background-color: #f4f6f6; }
        ul { list-style-type: none; padding-left: 0; margin: 0; }
        li { margin-bottom: 10px; }
        strong { font-weight: bold; }
        .food-details { font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <h1>Your Personalized Diet Plan</h1>
    <p>
        Here is the plan generated for <strong>{{ record.name }}</strong>, based on a BMI of <strong>{{ record.bmi }}</strong> 
        and a goal of <strong>{{ record.goal|title }}</strong>.
    </p>

    <h2>Daily Calorie Target: {{ plan_data.calories }} kcal</h2>
    
    <h3>Suggested Meal Schedule</h3>
    <table>
        <thead>
            <tr>
                <th>Time</th>
                <th>Meal</th>
                <th>Suggested Foods</th>
            </tr>
        </thead>
        <tbody>
            {% for meal in plan_data.meals %}
            <tr>
                <td><strong>{{ meal.time }}</strong></td>
                <td>{{ meal.name }}</td>
                <td>
                    <ul>
                    {% for item in meal.foods %}
                        <li>
                            <strong>{{ item.name|title }}</strong><br>
                            <span class="food-details">
                                {{ item.calories|round(0) }} kcal | P: {{ item.protein }}g | F: {{ item.fat }}g
                            </span>
                        </li>
                    {% endfor %}
                    </ul>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>